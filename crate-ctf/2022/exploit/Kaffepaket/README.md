# Kaffepaket

## Idé
Serialiseringssårbarhet i Java.
Simpelt program "sak-plats-databas" med möjlighet att lista, lägga till och ta bort saker från en "databas".
Databasen (array av saker) går att exportera via serialisering + base64, samt importera en tidigar exporterad databas.

Internt representeras databasen av en TreeList från apache commons-collections 3.1. Apache commons kan användas som "gadget"
för att få kodexekvering i samband med deserialisering av objekt. Opensource-projektet ysoserial kan använads för att tillverka
sådana serialiserade objekt. Ysoserial innehåller ett trettiotal olika payloads, och det är en enkel sak att scripta test
av dessa för att se vilken som fungerar.

Programmet innehåller ett "debugkommando" för att skriva ut en loggfil i /tmp, och lösningsförslaget är att skapa en payload
som exekverar en överskrivning av logfilen med flaggfilen och sedan dumpa loggen.

Det är säkert möjligt att göra en "custom payload" som läser in filen och skriver ut i konsolen direkt. Hatten av till 
de som gör det isåfall :-)

Sätt man kan göra uppgiften enklare:
 * Tillhandahålla .jar filen?
 * Hinta om att det är commons-collections:3.1 som används för att slippa bruteforce av payloads?

## Generera fungerande payload
 * Ladda ner ysoserial: https://github.com/frohoff/ysoserial
 ```java -jar ysoserial-all.jar CommonsCollections5 "cp /flag.txt /tmp/dblog.txt" | base64 -w0```

## Bygg javakoden
cd src && mvn install
kopiera target/jar till docker


