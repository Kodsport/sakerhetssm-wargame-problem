FROM oven/bun:1-slim AS base

ENV DEBIAN_FRONTEND noninteractive
RUN apt-get update && apt-get install -y xinetd && rm -rf /var/lib/apt/lists/*

COPY jsfs.js /home/bun/jsfs-src.js
RUN cd /home/bun && bun build --minify jsfs-src.js | fold -sw1024 > /jsfs.js
COPY ctf.xinetd /etc/xinetd.d/ctf

ENV FLAG=cratectf{den-h√§r-uppgiften-var-bara-en-prototyp}

CMD ["/usr/sbin/xinetd", "-dontfork"]
