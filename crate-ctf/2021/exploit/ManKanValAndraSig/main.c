#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>

void print_flag() {
    FILE *fptr = fopen("flag.txt", "r");
    if(fptr == NULL) {
        printf("Gick inte att öppna flag.txt... Om du kör mot servern, kontakta en admin.");
        exit(0);
    }

    char c;
    while((c = getc(fptr)) != EOF) {
        putchar(c);
    }
    fflush(stdout);
    fclose(fptr);
}

int main(int argc, char **argv) {
    setvbuf(stdout, 0, 2, 0);
    setvbuf(stdin, 0, 2, 0);

    volatile int changeme = 1337;
    char buf[32];

    read(STDIN_FILENO, &buf, 256);
    printf("Du skrev: %s\n", buf);

    printf("Det hemliga värdet är: %d\n", changeme);

    if(changeme == 0x66697864) {
        print_flag();
    } else {
        printf("Ingen flagga för dig!\n");
    }

    return 0;
}
